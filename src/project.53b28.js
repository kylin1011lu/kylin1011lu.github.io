window.__require=function t(e,o,r){function n(c,p){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var a="function"==typeof __require&&__require;if(!p&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return n(e[c][1][t]||t)},u,u.exports,t,e,o,r)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)n(r[c]);return n}({Block:[function(t,e,o){"use strict";cc._RF.push(e,"851b3hdMfRHL5kOFviMf0jg","Block");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var p=t.length-1;p>=0;p--)(n=t[p])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./EnumDefine"),c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.defaultFrame=null,e.nums=[],e.mines=[],e.flagFrame=null,e.blockType=i.BlockType.NUMBER,e.pos=new cc.Vec2(0,0),e._number=0,e._isOpen=!1,e._isFlag=!1,e}return r(e,t),Object.defineProperty(e.prototype,"isMine",{get:function(){return this.blockType==i.BlockType.MINE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"number",{set:function(t){t<0||t>8?cc.error("Block num out of range, num is "+t):this._number=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.blockType==i.BlockType.NUMBER&&0==this._number},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},set:function(t){this._isOpen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFlag",{get:function(){return this._isFlag},set:function(t){this._isFlag=t,this.sprite.spriteFrame=1==t?this.flagFrame:this.defaultFrame},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.open=function(t){this.isFlag?this.isFlag=!1:(this.isOpen=!0,this.blockType==i.BlockType.MINE?(this.sprite.spriteFrame=this.mines[1],cc.director.emit("game_over",!1)):this.blockType==i.BlockType.NUMBER&&(this.sprite.spriteFrame=this.nums[this._number],0==this._number&&t&&cc.director.emit("empty_click",this)))},e.prototype.onClicking=function(){this.sprite.spriteFrame=this.nums[0]},e.prototype.showDefault=function(){this.sprite.spriteFrame=this.defaultFrame},e.prototype.show=function(){this.blockType==i.BlockType.MINE?!this.isOpen&&(this.sprite.spriteFrame=this.mines[0]):this.blockType==i.BlockType.NUMBER&&(this.sprite.spriteFrame=this.nums[this._number])},n([s(cc.Sprite)],e.prototype,"sprite",void 0),n([s({type:cc.SpriteFrame,tooltip:"\u9ed8\u8ba4\u7684\u672a\u5f00\u542f\u56fe\u7247"})],e.prototype,"defaultFrame",void 0),n([s([cc.SpriteFrame])],e.prototype,"nums",void 0),n([s([cc.SpriteFrame])],e.prototype,"mines",void 0),n([s({type:cc.SpriteFrame,tooltip:"\u65d7\u5b50\u6807\u8bb0"})],e.prototype,"flagFrame",void 0),n([s({type:cc.Enum(i.BlockType)})],e.prototype,"blockType",void 0),n([s(cc.Vec2)],e.prototype,"pos",void 0),e=n([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{"./EnumDefine":"EnumDefine"}],Board:[function(t,e,o){"use strict";cc._RF.push(e,"e8e6810QZ1HQrwYzCv+xR/T","Board");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var p=t.length-1;p>=0;p--)(n=t[p])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Block"),c=t("./Border"),p=t("./EnumDefine"),s=t("./NodeUtil"),a=cc._decorator,u=a.ccclass,h=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boardSize=new cc.Vec2(10,10),e.blockWidth=40,e.mineCount=15,e.blockPrefab=null,e.borderPrefab=null,e._boardData=[],e._touchTime=null,e}return r(e,t),e.prototype.onLoad=function(){cc.director.on("game_over",function(){this.offTouchEvent(),this.endShow()},this),cc.director.on("restart",function(){this.reset()},this),cc.director.on("empty_click",function(t){this.calcForEmptyNumber(t)},this),this.create()},e.prototype.create=function(){this.initBoard(),this.initBorder(),this.createMine(),this.calcMineForNumber(),this.initTouchEvent()},e.prototype.reset=function(){s.MyNodeUtil.removeAllChildren(this.node),this._boardData=[],this.create()},e.prototype.initBoard=function(){for(var t=this.getBlockStartPosition(),e=0;e<this.boardSize.x;e++)for(var o=0;o<this.boardSize.y;o++){var r=cc.instantiate(this.blockPrefab);r.x=t.x+this.blockWidth/2+e*this.blockWidth,r.y=t.y+this.blockWidth/2+o*this.blockWidth,r.width=r.height=this.blockWidth,r.parent=this.node;var n=r.getComponent(i.default);n.pos=cc.v2(e,o),this._boardData.push(n)}},e.prototype.getBlockStartPosition=function(){var t=-1*(this.boardSize.x*this.blockWidth)/2,e=-1*(this.boardSize.y*this.blockWidth)/2;return cc.v2(t,e)},e.prototype.initBorder=function(){var t=this.boardSize.x*this.blockWidth,e=this.boardSize.y*this.blockWidth,o=cc.instantiate(this.borderPrefab);o.x=o.y=0,o.parent=this.node,o.getComponent(c.default).size=new cc.Size(t,e)},e.prototype.createMine=function(){for(var t=this,e=0,o=[];e<this.mineCount;){var r=Math.floor(Math.random()*this.boardSize.x*this.boardSize.y),n=o.length,i=!1;if(n)for(var c=0;c<n;c++)if(r==o[c]){i=!0;break}i||(o.push(r),e++)}o.map(function(e){t._boardData[e].blockType=p.BlockType.MINE})},e.prototype.calcMineForNumber=function(){var t=this;this._boardData.map(function(e){if(!e.isMine){var o=0;t.requestPos(e.pos).map(function(e){t._boardData[e.x*t.boardSize.y+e.y].isMine&&o++}),e.number=o}})},e.prototype.calcForEmptyNumber=function(t){var e=this;this.requestPos(t.pos).map(function(t){var o=e._boardData[t.x*e.boardSize.y+t.y];o.isOpen||(!o.isMine&&o.open(!1),o.isEmpty&&!o.isFlag&&e.calcForEmptyNumber(o))})},e.prototype.requestPos=function(t){var e=t.x,o=t.y,r=this.boardSize.x,n=this.boardSize.y;return[cc.v2(e-1,o-1),cc.v2(e,o-1),cc.v2(e+1,o-1),cc.v2(e-1,o),cc.v2(e+1,o),cc.v2(e-1,o+1),cc.v2(e,o+1),cc.v2(e+1,o+1)].filter(function(t){return!(t.x<0||t.y<0||t.x>=r||t.y>=n)})},e.prototype.offTouchEvent=function(){this.node.targetOff(this)},e.prototype.initTouchEvent=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.onTouchStart=function(t){cc.log("Board->onTouchStart"),this._touchTime=(new Date).getTime()},e.prototype.onTouchMove=function(t){cc.log("Board->onTouchMove");var e=t.getStartLocation(),o=t.getLocation();e.sub(o).mag()>5&&(this._touchTime=null)},e.prototype.onTouchEnd=function(t){cc.log("Board->onTouchEnd");for(var e=t.getLocation(),o=this._boardData.length-1;o>=0;o--){var r=this._boardData[o];if(!r.isOpen&&r.node.getBoundingBoxToWorld().contains(e)){var n=(new Date).getTime();this._touchTime&&n-this._touchTime>600?r.isFlag=!r.isFlag:r.open(!0),this.endCalc();break}}},e.prototype.onTouchCancel=function(t){cc.log("Board->onTouchCancel"),this._touchTime=null},e.prototype.endCalc=function(){for(var t=0,e=0,o=0;o<this._boardData.length;o++){var r=this._boardData[o];!r.isOpen&&r.isFlag&&t++,r.isOpen&&e++}t==this.mineCount&&e==this._boardData.length-this.mineCount&&cc.director.emit("game_over",!0)},e.prototype.endShow=function(){this._boardData.map(function(t){t.show()})},n([h({tooltip:"\u68cb\u76d8\u683c\u5b50\u6a2a\u7eb5\u65b9\u5411\u683c\u5b50\u6570\u76ee"})],e.prototype,"boardSize",void 0),n([h({tooltip:"\u68cb\u5b50\u8fb9\u957f"})],e.prototype,"blockWidth",void 0),n([h({tooltip:"\u96f7\u7684\u4e2a\u6570"})],e.prototype,"mineCount",void 0),n([h(cc.Prefab)],e.prototype,"blockPrefab",void 0),n([h({type:cc.Prefab,tooltip:"\u8fb9\u6846\u9884\u5236\u4f53"})],e.prototype,"borderPrefab",void 0),e=n([u],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Block":"Block","./Border":"Border","./EnumDefine":"EnumDefine","./NodeUtil":"NodeUtil"}],Border:[function(t,e,o){"use strict";cc._RF.push(e,"948b2xX1pNBV7vtcK+QCvlg","Border");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var p=t.length-1;p>=0;p--)(n=t[p])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,p=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._size=new cc.Size(0,0),e}return r(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t,this.node.width=t.width+48,this.node.height=t.height+44},enumerable:!0,configurable:!0}),n([p(cc.Size)],e.prototype,"_size",void 0),e=n([c],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],EnumDefine:[function(t,e,o){"use strict";cc._RF.push(e,"e5dc33VQ8tGE7pQI0iRb9rp","EnumDefine"),Object.defineProperty(o,"__esModule",{value:!0}),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NUMBER=1]="NUMBER",t[t.MINE=2]="MINE"}(o.BlockType||(o.BlockType={})),cc._RF.pop()},{}],MainScene:[function(t,e,o){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","MainScene");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var p=t.length-1;p>=0;p--)(n=t[p])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,p=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameOver=null,e}return r(e,t),e.prototype.onLoad=function(){cc.director.on("game_over",function(t){this.gameOver.active=!0,this.gameOver.getComponentInChildren(cc.Label).string=t?"\u80dc\u5229":"\u5931\u8d25"},this)},e.prototype.start=function(){},e.prototype.restart=function(){this.gameOver.active=!1,cc.director.emit("restart")},n([p(cc.Node)],e.prototype,"gameOver",void 0),e=n([c],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],NodeUtil:[function(t,e,o){"use strict";cc._RF.push(e,"dfb16aS5B5PTbt24YySdRaK","NodeUtil"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.removeAllChildren=function(t,e){void 0===e&&(e=!0);var o=t.children;void 0===e&&(e=!0);for(var r=o.length-1;r>=0;r--){var n=o[r];n&&(e&&n.cleanup(),n.parent=null,n.destroy())}t.children.length=0},t}();o.MyNodeUtil=new r,cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e,o){"use strict";cc._RF.push(e,"94a76st5QJOhaxXaoffHwbM","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["Block","Board","Border","EnumDefine","MainScene","NodeUtil","use_v2.1-2.2.1_cc.Toggle_event"]);